<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.nhn.www.event.mapper.BannerEventItemMapper" >
    <resultMap id="CustomResultMap" type="com.nhn.www.event.bean.BannerEventItemAndImg" >
	    <!--
	      WARNING - @mbggenerated
	      This element is automatically generated by MyBatis Generator, do not modify.
	      This element was generated on Wed Apr 26 16:14:34 KST 2017.
	    -->
	    <id column="item_key" property="itemKey" jdbcType="INTEGER" />
	    <result column="prob" property="prob" jdbcType="DOUBLE" />
	    <result column="descript" property="descript" jdbcType="VARCHAR" />
	    <result column="item_serial" property="itemSerial" jdbcType="INTEGER" />
	    <result column="item_type" property="itemType" jdbcType="INTEGER" />
	    <result column="item_count" property="itemCount" jdbcType="INTEGER" />
	    <result column="local" property="local" jdbcType="VARCHAR" />
	    <result column="url" property="url" jdbcType="VARCHAR" />
    </resultMap>
    
    <select id="selectBannerEventItemAndImg" resultMap="CustomResultMap" parameterType="java.lang.String">
        select 
		    item.item_key,
		    prob,
		    descript,
		    item_serial,
		    item_type,
		    item_count,
		    local,
		    url
	    from (  
	    select * 
	    from banner_event_item
	    where used='T'
	    )item, banner_event_item_img img
	    where item.item_key = img.item_key
	    and img.local=#{lang}
	    order by prob asc
    </select>
    
    <select id="getLiveItemsAndLocalUrl" resultMap="CustomResultMap">
        select 
	    item.item_key,
	    prob,
	    descript,
	    item_serial,
	    item_type,
	    item_count,
	    local,
	    url
	    from (  
	    select * 
	    from banner_event_item
	    where used='T'
	    )item, banner_event_item_img img
	    where item.item_key = img.item_key
	
	    order by item.item_key, prob asc
    </select>
    
    <select id="getLiveItems" resultMap="CustomResultMap">
        select 
	    item.item_key,
	    prob,
	    descript
	    
	    from (  
	    select * 
	    from banner_event_item
	    where used='T'
	    )item, banner_event_item_img img
	    where item.item_key = img.item_key
	
	    group by item.item_key
    </select>
</mapper>